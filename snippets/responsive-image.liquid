{%- capture style -%}
    {% assign asp_rat = aspect_ratio | default: image.aspect_ratio %}
    {% if asp_rat == 'adapt' %}
        --aspect-ratio: {{ image.aspect_ratio }};
    {% else %}
        --aspect-ratio: {{ asp_rat }};
    {% endif %}
    {% if image_width %}
        --image-width: {{ image_width }};
    {% endif %}
{%- endcapture -%}

{% liquid
    if no_zoom
        assign wrapper_class = wrapper_class | append: ' f-image--no-zoom'
    endif
%}
<responsive-image class="f-image {{ wrapper_class }}" data-image-loading {{ wrapper_attributes }} style="{{ style | strip | strip_newlines }}">
    <img
        srcset="{%- if image.width >= 165 -%}{{ image | image_url: width: 165 }} 165w,{%- endif -%}
            {%- if image.width >= 360 -%}{{ image | image_url: width: 360 }} 360w,{%- endif -%}
            {%- if image.width >= 533 -%}{{ image | image_url: width: 533 }} 533w,{%- endif -%}
            {%- if image.width >= 720 -%}{{ image | image_url: width: 720 }} 720w,{%- endif -%}
            {%- if image.width >= 940 -%}{{ image | image_url: width: 940 }} 940w,{%- endif -%}
            {%- if image.width >= 1066 -%}{{ image | image_url: width: 1066 }} 1066w,{%- endif -%}
            {%- if image.width >= 1500 -%}{{ image | image_url: width: 1500 }} 1500w,{%- endif -%}
            {%- if image.width >= 1780 -%}{{ image | image_url: width: 1780 }} 1780w,{%- endif -%}
            {%- if image.width >= 2000 -%}{{ image | image_url: width: 2000 }} 2000w,{%- endif -%}
            {{ image | image_url }} {{ image.width }}w"
        src="{{ image | image_url: width: 360 }}"
        sizes="(min-width: {{ settings.container_width }}px) {{ settings.container_width | minus: 130 | divided_by: 4 }}px, (min-width: 990px) calc((100vw - 130px) / 4), (min-width: 750px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)"
        alt="{{ alt | default: image.alt | escape }}"
        {% unless lazy_load == false %}loading="lazy"{% endunless %}
        class="{{ image_class }}"
        width="{{ image.width }}"
        height="{{ image.height }}"
        {{ image_attributes }}
    >
</responsive-image>
